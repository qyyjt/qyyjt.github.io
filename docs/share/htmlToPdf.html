<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>html-pdf-node 打印插件 | 企业预警通 app 文档</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/docs/icon.png">
    <meta name="description" content="xxx ">
    
    <link rel="preload" href="/docs/assets/css/0.styles.52bb2005.css" as="style"><link rel="preload" href="/docs/assets/js/app.9c4a87da.js" as="script"><link rel="preload" href="/docs/assets/js/2.ee7ef9dc.js" as="script"><link rel="preload" href="/docs/assets/js/25.2ec0596c.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.db647659.js"><link rel="prefetch" href="/docs/assets/js/11.157fa146.js"><link rel="prefetch" href="/docs/assets/js/12.9bbad37f.js"><link rel="prefetch" href="/docs/assets/js/13.fe9d6361.js"><link rel="prefetch" href="/docs/assets/js/14.802f8647.js"><link rel="prefetch" href="/docs/assets/js/15.a4690bc7.js"><link rel="prefetch" href="/docs/assets/js/16.8da8a0f5.js"><link rel="prefetch" href="/docs/assets/js/17.0f9d2f38.js"><link rel="prefetch" href="/docs/assets/js/18.d863931b.js"><link rel="prefetch" href="/docs/assets/js/19.68e73512.js"><link rel="prefetch" href="/docs/assets/js/20.b976bd51.js"><link rel="prefetch" href="/docs/assets/js/21.8b9e1cd1.js"><link rel="prefetch" href="/docs/assets/js/22.2eecbc35.js"><link rel="prefetch" href="/docs/assets/js/23.368ae816.js"><link rel="prefetch" href="/docs/assets/js/24.be06e9e0.js"><link rel="prefetch" href="/docs/assets/js/26.82ab70ff.js"><link rel="prefetch" href="/docs/assets/js/27.ee32ff3d.js"><link rel="prefetch" href="/docs/assets/js/28.4148a519.js"><link rel="prefetch" href="/docs/assets/js/29.fd35b079.js"><link rel="prefetch" href="/docs/assets/js/3.adcbcd77.js"><link rel="prefetch" href="/docs/assets/js/30.6de8dea2.js"><link rel="prefetch" href="/docs/assets/js/31.debf0bb0.js"><link rel="prefetch" href="/docs/assets/js/32.3e149feb.js"><link rel="prefetch" href="/docs/assets/js/33.db962026.js"><link rel="prefetch" href="/docs/assets/js/34.ae6d7ba1.js"><link rel="prefetch" href="/docs/assets/js/4.960c93c7.js"><link rel="prefetch" href="/docs/assets/js/5.b99acfdc.js"><link rel="prefetch" href="/docs/assets/js/6.845675fc.js"><link rel="prefetch" href="/docs/assets/js/7.bac58ff9.js"><link rel="prefetch" href="/docs/assets/js/8.1ecbcb9f.js"><link rel="prefetch" href="/docs/assets/js/9.08296b2b.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.52bb2005.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">企业预警通 app 文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/docs/standard/codeSpecification.html" class="nav-link">
  代码规范
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常见问题" class="dropdown-title"><span class="title">常见问题</span> <span class="arrow down"></span></button> <button type="button" aria-label="常见问题" class="mobile-dropdown-title"><span class="title">常见问题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/problem/tableScroll.html" class="nav-link">
  关于表格滚动问题说明
</a></li><li class="dropdown-item"><!----> <a href="/docs/problem/howToSolve.html" class="nav-link">
  问题处理文档
</a></li><li class="dropdown-item"><!----> <a href="/docs/problem/differentModels.html" class="nav-link">
  机型兼容性问题
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目资料" class="dropdown-title"><span class="title">项目资料</span> <span class="arrow down"></span></button> <button type="button" aria-label="项目资料" class="mobile-dropdown-title"><span class="title">项目资料</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/project/cdnPath.html" class="nav-link">
  公用 cdn 插件地址
</a></li><li class="dropdown-item"><!----> <a href="/docs/project/gulpConfig.html" class="nav-link">
  gulpfile 配置
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分享" class="dropdown-title"><span class="title">分享</span> <span class="arrow down"></span></button> <button type="button" aria-label="分享" class="mobile-dropdown-title"><span class="title">分享</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/share/performanceOptimization.html" class="nav-link">
  前端性能优化--图片
</a></li><li class="dropdown-item"><!----> <a href="/docs/share/svnAddress.html" class="nav-link">
  前端svn
</a></li><li class="dropdown-item"><!----> <a href="/docs/share/pageSuggestion.html" class="nav-link">
  页面建议（UI）
</a></li><li class="dropdown-item"><!----> <a href="/docs/share/mobileDevelopment.html" class="nav-link">
  移动开发要点
</a></li><li class="dropdown-item"><!----> <a href="/docs/share/nativeJump.html" class="nav-link">
  原生跳转URL
</a></li><li class="dropdown-item"><!----> <a href="/docs/share/htmlEmail.html" class="nav-link">
  html邮箱编写规则
</a></li><li class="dropdown-item"><!----> <a href="/docs/share/htmlToPdf.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  html转pdf
</a></li><li class="dropdown-item"><!----> <a href="/docs/share/BottomSafetyDistance.html" class="nav-link">
  ios底部安全距离 
</a></li><li class="dropdown-item"><!----> <a href="/docs/share/webExtension.html" class="nav-link">
  web 扩展
</a></li><li class="dropdown-item"><!----> <a href="/docs/share/CompositionVSOption.html" class="nav-link">
  Composition API VS Option API
</a></li><li class="dropdown-item"><!----> <a href="/docs/share/vue3.0.html" class="nav-link">
  vue3.0入门
</a></li><li class="dropdown-item"><!----> <a href="/docs/share/webhookRelease.html" class="nav-link">
  webhook自动发版
</a></li></ul></div></div><div class="nav-item"><a href="/docs/onboarding/manual.html" class="nav-link">
  入职
</a></div> <a href="https://git.finchina.com/hf-develop/web/1/vue_group/tree/master/qyyjt-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/docs/standard/codeSpecification.html" class="nav-link">
  代码规范
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常见问题" class="dropdown-title"><span class="title">常见问题</span> <span class="arrow down"></span></button> <button type="button" aria-label="常见问题" class="mobile-dropdown-title"><span class="title">常见问题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/problem/tableScroll.html" class="nav-link">
  关于表格滚动问题说明
</a></li><li class="dropdown-item"><!----> <a href="/docs/problem/howToSolve.html" class="nav-link">
  问题处理文档
</a></li><li class="dropdown-item"><!----> <a href="/docs/problem/differentModels.html" class="nav-link">
  机型兼容性问题
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目资料" class="dropdown-title"><span class="title">项目资料</span> <span class="arrow down"></span></button> <button type="button" aria-label="项目资料" class="mobile-dropdown-title"><span class="title">项目资料</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/project/cdnPath.html" class="nav-link">
  公用 cdn 插件地址
</a></li><li class="dropdown-item"><!----> <a href="/docs/project/gulpConfig.html" class="nav-link">
  gulpfile 配置
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分享" class="dropdown-title"><span class="title">分享</span> <span class="arrow down"></span></button> <button type="button" aria-label="分享" class="mobile-dropdown-title"><span class="title">分享</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/share/performanceOptimization.html" class="nav-link">
  前端性能优化--图片
</a></li><li class="dropdown-item"><!----> <a href="/docs/share/svnAddress.html" class="nav-link">
  前端svn
</a></li><li class="dropdown-item"><!----> <a href="/docs/share/pageSuggestion.html" class="nav-link">
  页面建议（UI）
</a></li><li class="dropdown-item"><!----> <a href="/docs/share/mobileDevelopment.html" class="nav-link">
  移动开发要点
</a></li><li class="dropdown-item"><!----> <a href="/docs/share/nativeJump.html" class="nav-link">
  原生跳转URL
</a></li><li class="dropdown-item"><!----> <a href="/docs/share/htmlEmail.html" class="nav-link">
  html邮箱编写规则
</a></li><li class="dropdown-item"><!----> <a href="/docs/share/htmlToPdf.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  html转pdf
</a></li><li class="dropdown-item"><!----> <a href="/docs/share/BottomSafetyDistance.html" class="nav-link">
  ios底部安全距离 
</a></li><li class="dropdown-item"><!----> <a href="/docs/share/webExtension.html" class="nav-link">
  web 扩展
</a></li><li class="dropdown-item"><!----> <a href="/docs/share/CompositionVSOption.html" class="nav-link">
  Composition API VS Option API
</a></li><li class="dropdown-item"><!----> <a href="/docs/share/vue3.0.html" class="nav-link">
  vue3.0入门
</a></li><li class="dropdown-item"><!----> <a href="/docs/share/webhookRelease.html" class="nav-link">
  webhook自动发版
</a></li></ul></div></div><div class="nav-item"><a href="/docs/onboarding/manual.html" class="nav-link">
  入职
</a></div> <a href="https://git.finchina.com/hf-develop/web/1/vue_group/tree/master/qyyjt-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>html-pdf-node 打印插件</span> <!----></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h4 id="html-pdf-node-打印插件"><a href="#html-pdf-node-打印插件" class="header-anchor">#</a> html-pdf-node 打印插件</h4> <html>
文档地址：https://www.npmjs.com/package/html-pdf-node
</html> <div class="language- extra-class"><pre class="language-text"><code>插件安装：
npm i html-pdf-node
npm i puppeteer
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>&lt;style&gt;
    .page-break-before {
      page-break-before: always; //分页符
    }
    .page-break-avoid {
        page-break-inside: avoid; //避免在元素内部插入分页符
    }
&lt;/style&gt;
&lt;script&gt;
    // 分页逻辑
    function addPageBreak() {
        let doc = document.querySelectorAll('.echarts-page'); //获取所有可能需要分页的元素
        let index_h = document.getElementById('indexHome').offsetHeight;//封面高度
        let a4_h = 952;  //A4纸：794×1123, 浏览器打印内容高度：588*1040, pdf插件打印内容高度：595*952

        let prev_top = 0; //上个分页节点位置
        doc.forEach(item =&gt; {
            let t = item.getBoundingClientRect().top,//当前节点所在位置
                h = item.offsetHeight;//当前节点内容高度
            let surplus = (t + h - index_h - prev_top) % a4_h; //取余

            if (Math.abs(surplus) &lt; h) {  //当前节点被分页截断
                item.classList.add(&quot;page-break-before&quot;);    //添加分页
               
                let classList = item.className;
                if (classList.indexOf('echarts-page-table') != -1) {  //分页标签在表格上面，若表格可被分页截断，执行以下代码
                    let tab = (h - Math.abs(surplus)) % a4_h; //取余
                    if (Math.abs(tab) &gt;= 100) { //打印时底部留白区域范围
                        item.classList.remove(&quot;page-break-before&quot;);
                    } else {
                        prev_top = t - index_h;
                    }
                } else {
                    prev_top = t - index_h;
                }
            }
        });
    }
&lt;/script&gt;
</code></pre></div><h5 id="html-pdf-node-打印脚本-pdf-print-js"><a href="#html-pdf-node-打印脚本-pdf-print-js" class="header-anchor">#</a> html-pdf-node 打印脚本: pdf-print.js</h5> <div class="language- extra-class"><pre class="language-text"><code>var html_to_pdf = require('html-pdf-node');
var fs = require(&quot;fs&quot;);
let options = {
  args: [
    &quot;--no-sandbox&quot;,
    &quot;--disable-setuid-sandbox&quot;,
    &quot;--allow-file-access-from-file&quot;,
  ],
  format: &quot;A4&quot;, //pdf插件打印内容高度：595* 952, A4纸：794×1123
  // landscape: true, //是否横向打印
  // scale: 2, //缩放0.1-2之间
  margin: {
    top: &quot;15mm&quot;,
    bottom: &quot;15mm&quot;,
    left: 0,
    right: 0,
  },
  displayHeaderFooter: true, //是否展示页眉页尾
  
  /**
  * 页眉页尾可配置参数
  * @params title标题 date时间 url路径 pageNumber页码 totalPages总页码
  */
  // 页眉模板
  headerTemplate: `
 &lt;div style=&quot;color: #111111;margin: 0 auto;width:12cm;font-size: 2.5mm;border-bottom: 0.1mm
solid #d6d6d6;padding-bottom: 0.5mm;&quot;&gt;
    &lt;span class='title'&gt;&lt;/span&gt;
 &lt;/div&gt;
 `,

  // 页尾模板
  footerTemplate: `
 &lt;div style=&quot;color: #111111;width: 12cm; margin: 0 auto; border-top: 0.1mm solid
#d6d6d6; font-size: 2.5mm; padding-top: 0.5mm; text-align: right;&quot;&gt;
    &lt;span class=&quot;pageNumber&quot;&gt;&lt;/span&gt;/&lt;span class=&quot;totalPages&quot;&gt;&lt;/span&gt;
 &lt;/div&gt;
 `,
  printBackground: true, //打印背景图形
};

function printPDF(param) {
  let file = param.file || [{ url: &quot;https://example.com&quot;, name: 'example.pdf' }];
  let distLocation = param.distLocation || ('./' + file[0].name);  //pdf文件保存地址

  // 生成PDF文件并保存至当前文件夹
  html_to_pdf.generatePdfs(file, options).then(output =&gt; {
    console.log(&quot;PDF Buffer:-&quot;, output); // PDF Buffer:- [{url: &quot;https://example.com&quot;, name: &quot;example.pdf&quot;, buffer: &lt;PDF buffer&gt;}]

    // fs.writeFile('文件路径'，'要写入的内容'，['编码']，'回调函数');
    fs.writeFile(distLocation, output[0].buffer, &quot;binary&quot;, function (err) {
      if (err) {
        console.error(&quot;文件保存失败&quot;, err);
      } else {
        console.log(&quot; 文件已保存！&quot;);
      }
    });
  });
}

//执行打印
printPDF({
  file: [{ url: &quot;F:/项目文件/企业预警通/bondReports/1.html&quot;, name: '1.pdf' }],
  distLocation: './1.pdf'
});

// export default {
//   printPDF
// }

</code></pre></div><p>cmd终端执行打印pdf命令</p> <div class="language- extra-class"><pre class="language-text"><code>node .\pdf-print.js
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/17/2022, 1:46:59 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.9c4a87da.js" defer></script><script src="/docs/assets/js/2.ee7ef9dc.js" defer></script><script src="/docs/assets/js/25.2ec0596c.js" defer></script>
  </body>
</html>
